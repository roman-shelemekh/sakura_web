{% extends "admin.html" %}

{% block right_column %}
<h3 class="mb-3">Посещение от {{ appointment.date.strftime("%d.%m.%Y") }} в {{ appointment.time.strftime("%H:%M") }}</h3>
<form action="" method="post" class="needs-validation" novalidate>
    <div>{{ form.hidden_tag() }}</div>
    <div class="form-floating mb-3">
        {{ form.date(class='form-control' + (" is-invalid" if form.date.errors else ""), placeholder='Дата', id='id_date', type='date') }}
        <label for="id_date">Дата</label>
        {% if form.date.errors %}
        <div id="id_date" class="invalid-feedback">
            {% for error in form.date.errors %}
            {{ error }}
            {% endfor %}
        </div>
        {% endif %}
    </div>
        <div class="form-floating mb-3">
        {{ form.time(class='form-control' + (" is-invalid" if form.time.errors else ""), placeholder='Время', id='id_time', type='time', step='600') }}
        <label for="id_time">Время</label>
        {% if form.time.errors %}
        <div id="id_time" class="invalid-feedback">
            {% for error in form.time.errors %}
            {{ error }}
            {% endfor %}
        </div>
        {% endif %}
    </div>
    <div class="form-floating mb-3">
        {{ form.salon(class="form-select", placeholder='Парикмахерская', id='id_salon') }}
        <label for="id_salon">Парикмахерская</label>
    </div>
    <div class="form-floating mb-3">
        {{ form.client(class='form-control' + (" is-invalid" if form.client.errors else ""), placeholder='Клиент', id='id_client', list='clients_list') }}
        <label for="id_client">Клиент</label>
        <datalist id="clients_list" data-url="{{ url_for('get_clients')}}"></datalist>
        {% if form.client.errors %}
        <div id="id_client" class="invalid-feedback">
            {% for error in form.client.errors %}
            {{ error }}
            {% endfor %}
        </div>
        {% endif %}
    </div>
    <div class="form-floating mb-3" data-url="{{ url_for('get_hairdressers') }}">
        {{ form.hairdresser(class="form-select", placeholder='Мастер', id='id_hairdresser') }}
        <label for="id_hairdresser">Мастер</label>
    </div>
    <div class="form-floating mb-3">
        {{ form.comment(class='form-control' + (" is-invalid" if form.comment.errors else ""), placeholder='Комментарий', style='height: 100px;', id='id_comment') }}
        <label for="id_comment">Комментарий</label>
        {% if form.comment.errors %}
        <div id="id_comment" class="invalid-feedback">
            {% for error in form.comment.errors %}
            {{ error }}
            {% endfor %}
        </div>
        {% endif %}
    </div>
    <div class="form-check form-switch mb-3">
        {{ form.accomplished(class="form-check-input", type="checkbox", id="id_accomplished") }}
        <label class="form-check-label" for="id_accomplished">Посещение состоялось</label>
    </div>

    <div class="d-grid gap-2 mb-3">
        <button class="btn btn-lg btn-primary" type="submit">Внести изменения</button>
    </div>
</form>
<div class="d-grid gap-2 mb-3">
    <a href="{{ url_for('delete_appointment', appointment_id=appointment.id) }}" class="btn btn-lg btn-danger" onclick="return confirm('Вы уверены?');">Удалить запись</a>
</div>
{% endblock %}

{% block script %}
<script type="text/javascript" src="{{ url_for('staticfiles', filename='appointment_detail.js') }}"></script>
{% endblock %}